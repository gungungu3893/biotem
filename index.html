<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BIOTEM · Pi 로그인</title>
  <script src="https://sdk.minepi.com/pi-sdk.js"></script>
</head>
<body style="font-family:sans-serif;text-align:center;padding:40px">

  <h1>BIOTEM</h1>
  <p>Pi 지갑 로그인</p>

  <button id="loginBtn" style="padding:15px 30px;font-size:18px">
    Pi 로그인
  </button>

  <p id="status" style="margin-top:20px;font-weight:bold"></p>

  <script>
    const status = document.getElementById("status");
    const btn = document.getElementById("loginBtn");

    if (!window.Pi) {
      status.innerText = "❌ Pi Browser에서 열어주세요";
      btn.disabled = true;
    } else {
      Pi.init({ version: "2.0", sandbox: true });
    }

    btn.onclick = async () => {
      status.innerText = "로그인 중...";
      try {
        const auth = await Pi.authenticate(
          ["username", "payments"],
          () => {}
        );
        status.innerText = "✅ 로그인 성공: " + auth.user.username;

        // 로그인 성공 → 결제 페이지 이동
        setTimeout(() => {
          window.location.href = "products.html";
        }, 800);

      } catch (e) {
        status.innerText = "❌ 로그인 실패";
        console.error(e);
      }
    };
  </script>
</body>
</html>
