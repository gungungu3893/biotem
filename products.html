<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BIOTEM · 결제 테스트</title>
  <script src="https://sdk.minepi.com/pi-sdk.js"></script>
</head>
<body style="font-family:sans-serif;text-align:center;padding:40px">

  <h2>BIOTEM 테스트 결제</h2>
  <p>임플란트 지주대 샘플</p>
  <p style="font-weight:bold;color:#c0392b">0.1 Test-Pi</p>

  <button id="payBtn" style="padding:15px 30px;font-size:18px">
    결제하기
  </button>

  <p id="status" style="margin-top:20px"></p>

  <script>
    const status = document.getElementById("status");
    const btn = document.getElementById("payBtn");

    if (!window.Pi) {
      status.innerText = "❌ Pi Browser에서만 결제 가능";
      btn.disabled = true;
    } else {
      Pi.init({ version: "2.0", sandbox: true });
    }

    btn.onclick = async () => {
      status.innerText = "결제창 여는 중...";

      try {
        await Pi.createPayment(
          {
            amount: 0.1,
            memo: "BIOTEM 테스트 결제",
            metadata: { product: "abutment_sample" }
          },
          {
            onReadyForServerApproval: (paymentId) => {
              status.innerText = "지갑 승인 대기중 (" + paymentId + ")";
            },
            onReadyForServerCompletion: (paymentId, txid) => {
              status.innerText = "✅ 결제 성공";
            },
            onCancel: () => {
              status.innerText = "❌ 결제 취소";
            },
            onError: (err) => {
              status.innerText = "❌ 에러: " + err.message;
            }
          }
        );
      } catch (e) {
        status.innerText = "❌ 결제창 호출 실패";
        console.error(e);
      }
    };
  </script>
</body>
</html>
